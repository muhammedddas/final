# -------------------------------------------------------------------------- ###
# Soru 1a ---- https://github.com/muhammedddas/final.git
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 2a ---- library(dplyr)

titanic %>%
  group_by(sex) %>%
  summarise(mean_fare = mean(fare))

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 2b ---- library(ggplot2)

ggplot(data = na.omit(titanic), aes(x = sex, y = age)) +
  geom_boxplot() +
  labs(x = "Cinsiyet", y = "Yaş") +
  ggtitle("Cinsiyete Göre Yaş Dağılımı")

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 2c ----
data %>%
  ggplot(aes(x = age)) +
  geom_histogram(aes(y = ..density..),
                 colour = "black", 
                 fill = "white") +
  geom_density(alpha = 0.5, 
               fill = "#ffc1c1") 
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3a ----
             10  13  16  19
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3b ----  library(dplyr)

dat3 <- inner_join(dat1, dat2)
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3c ---- data %>% 
ggplot(aes(x = a, y = b)) +
  geom_point() +
  geom_smooth() +
  scale_x_continuous("a")+
  scale_y_continuous("b")

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3d ----  [1] 2.0 NA

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3e ----
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3f ----  simulate_dice_roll <- function() {
# İki zar atışını taklit etmek için rastgele sayılar üretme
dice1 <- sample(1:6, 1, replace = TRUE)
dice2 <- sample(1:6, 1, replace = TRUE)

# Her bir zarın sonucunu gösterme
cat("Zar 1: ", dice1, "\n")
cat("Zar 2: ", dice2, "\n")

# Zarların toplamını döndürme
return(dice1 + dice2)


# Fonksiyonu çağırarak zar atışı simülasyonunu yapma
result <- simulate_dice_roll()
cat("Zarların toplamı: ", result, "\n")

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3g ----
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 4a ----   library(tidyr)

dat <- data.frame(
  country = c("_Ingiltere", "Almanya"),
  '2018' = c(8000, 10000),
  '2019' = c(8100, 11000),
  '2020' = c(8500, 10200)
)

dat2 <- dat %>% 
  pivot_longer(cols = -country, names_to = "year", values_to = "gdp")





# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 5a ----   dat %>%
ggplot() +
  aes(x = price, group = cut, fill = cut) +
  geom_density() +
  facet_wrap(~cut) +
  labs(y = "Density", x = "Price", title = "Stata Theme") +
  ggthemes::theme_stata() +
  theme(legend.position = "none")
# -------------------------------------------------------------------------- ###